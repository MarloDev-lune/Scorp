<!DOCTYPE html>
<html>
<head>
  <title>Scorp Chat</title>
  <style>
    body { font-family: Arial; background-color: #111; color: white; padding: 20px; }
    #messages { max-height: 400px; overflow-y: scroll; margin-bottom: 20px; }
    .msg { margin: 10px 0; padding: 10px; background: #222; border-radius: 5px; }
    .msg.me { background: #0f0; color: black; }
    .msg button { float: right; background: red; border: none; color: white; cursor: pointer; }
  </style>
</head>
<body>
  <h2>Scorp Live Chat</h2>
  <div id="messages"></div>
  <input id="msg-input" placeholder="Write a message..." style="width: 70%;">
  <button onclick="sendMessage()">Send</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, push, onChildAdded, remove } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBb1EHZlBZ6Fuzz8oJEzu92dQRQp82ukuE",
      authDomain: "scorpchat-c2c53.firebaseapp.com",
      projectId: "scorpchat-c2c53",
      storageBucket: "scorpchat-c2c53.firebasestorage.app",
      messagingSenderId: "1057027114582",
      appId: "1:1057027114582:web:9f0b00b920c920a2055df7",
      measurementId: "G-81B2Z87JFJ"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const chatRef = ref(db, "messages");

    const username = localStorage.getItem("logged_in_email") || "Anonymous";

    function sendMessage() {
      const input = document.getElementById("msg-input");
      if (input.value.trim()) {
        push(chatRef, {
          user: username,
          text: input.value
        });
        input.value = "";
      }
    }

    onChildAdded(chatRef, data => {
      const msg = data.val();
      const div = document.createElement("div");
      div.className = "msg" + (msg.user === username ? " me" : "");
      div.textContent = `${msg.user}: ${msg.text}`;
      if (msg.user === username) {
        const btn = document.createElement("button");
        btn.textContent = "Delete";
        btn.onclick = () => remove(data.ref);
        div.appendChild(btn);
      }
      document.getElementById("messages").appendChild(div);
    });
  </script>
</body>
</html>
